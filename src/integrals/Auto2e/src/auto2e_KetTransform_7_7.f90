module auto2e_KetTransform_7_7
use arithmetic
use math_constants
implicit none

integer, dimension(36, 36), parameter :: RCopyIdx_7_7 = reshape([1, 16, 30, 43, 55, &
    66, 76, 85, 121, 135, 148, 160, 171, 181, 190, 226, 239, 251, 262, 272, 281, &
    317, 329, 340, 350, 359, 395, 406, 416, 425, 461, 471, 480, 516, 525, 561, 16, &
    30, 43, 55, 66, 76, 85, 93, 135, 148, 160, 171, 181, 190, 198, 239, 251, 262, &
    272, 281, 289, 329, 340, 350, 359, 367, 406, 416, 425, 433, 471, 480, 488, 525, &
    533, 569, 30, 43, 55, 66, 76, 85, 93, 100, 148, 160, 171, 181, 190, 198, 205, &
    251, 262, 272, 281, 289, 296, 340, 350, 359, 367, 374, 416, 425, 433, 440, 480, &
    488, 495, 533, 540, 576, 43, 55, 66, 76, 85, 93, 100, 106, 160, 171, 181, 190, &
    198, 205, 211, 262, 272, 281, 289, 296, 302, 350, 359, 367, 374, 380, 425, 433, &
    440, 446, 488, 495, 501, 540, 546, 582, 55, 66, 76, 85, 93, 100, 106, 111, 171, &
    181, 190, 198, 205, 211, 216, 272, 281, 289, 296, 302, 307, 359, 367, 374, 380, &
    385, 433, 440, 446, 451, 495, 501, 506, 546, 551, 587, 66, 76, 85, 93, 100, 106, &
    111, 115, 181, 190, 198, 205, 211, 216, 220, 281, 289, 296, 302, 307, 311, 367, &
    374, 380, 385, 389, 440, 446, 451, 455, 501, 506, 510, 551, 555, 591, 76, 85, &
    93, 100, 106, 111, 115, 118, 190, 198, 205, 211, 216, 220, 223, 289, 296, 302, &
    307, 311, 314, 374, 380, 385, 389, 392, 446, 451, 455, 458, 506, 510, 513, 555, &
    558, 594, 85, 93, 100, 106, 111, 115, 118, 120, 198, 205, 211, 216, 220, 223, &
    225, 296, 302, 307, 311, 314, 316, 380, 385, 389, 392, 394, 451, 455, 458, 460, &
    510, 513, 515, 558, 560, 596, 121, 135, 148, 160, 171, 181, 190, 198, 226, 239, &
    251, 262, 272, 281, 289, 317, 329, 340, 350, 359, 367, 395, 406, 416, 425, 433, &
    461, 471, 480, 488, 516, 525, 533, 561, 569, 597, 135, 148, 160, 171, 181, 190, &
    198, 205, 239, 251, 262, 272, 281, 289, 296, 329, 340, 350, 359, 367, 374, 406, &
    416, 425, 433, 440, 471, 480, 488, 495, 525, 533, 540, 569, 576, 604, 148, 160, &
    171, 181, 190, 198, 205, 211, 251, 262, 272, 281, 289, 296, 302, 340, 350, 359, &
    367, 374, 380, 416, 425, 433, 440, 446, 480, 488, 495, 501, 533, 540, 546, 576, &
    582, 610, 160, 171, 181, 190, 198, 205, 211, 216, 262, 272, 281, 289, 296, 302, &
    307, 350, 359, 367, 374, 380, 385, 425, 433, 440, 446, 451, 488, 495, 501, 506, &
    540, 546, 551, 582, 587, 615, 171, 181, 190, 198, 205, 211, 216, 220, 272, 281, &
    289, 296, 302, 307, 311, 359, 367, 374, 380, 385, 389, 433, 440, 446, 451, 455, &
    495, 501, 506, 510, 546, 551, 555, 587, 591, 619, 181, 190, 198, 205, 211, 216, &
    220, 223, 281, 289, 296, 302, 307, 311, 314, 367, 374, 380, 385, 389, 392, 440, &
    446, 451, 455, 458, 501, 506, 510, 513, 551, 555, 558, 591, 594, 622, 190, 198, &
    205, 211, 216, 220, 223, 225, 289, 296, 302, 307, 311, 314, 316, 374, 380, 385, &
    389, 392, 394, 446, 451, 455, 458, 460, 506, 510, 513, 515, 555, 558, 560, 594, &
    596, 624, 226, 239, 251, 262, 272, 281, 289, 296, 317, 329, 340, 350, 359, 367, &
    374, 395, 406, 416, 425, 433, 440, 461, 471, 480, 488, 495, 516, 525, 533, 540, &
    561, 569, 576, 597, 604, 625, 239, 251, 262, 272, 281, 289, 296, 302, 329, 340, &
    350, 359, 367, 374, 380, 406, 416, 425, 433, 440, 446, 471, 480, 488, 495, 501, &
    525, 533, 540, 546, 569, 576, 582, 604, 610, 631, 251, 262, 272, 281, 289, 296, &
    302, 307, 340, 350, 359, 367, 374, 380, 385, 416, 425, 433, 440, 446, 451, 480, &
    488, 495, 501, 506, 533, 540, 546, 551, 576, 582, 587, 610, 615, 636, 262, 272, &
    281, 289, 296, 302, 307, 311, 350, 359, 367, 374, 380, 385, 389, 425, 433, 440, &
    446, 451, 455, 488, 495, 501, 506, 510, 540, 546, 551, 555, 582, 587, 591, 615, &
    619, 640, 272, 281, 289, 296, 302, 307, 311, 314, 359, 367, 374, 380, 385, 389, &
    392, 433, 440, 446, 451, 455, 458, 495, 501, 506, 510, 513, 546, 551, 555, 558, &
    587, 591, 594, 619, 622, 643, 281, 289, 296, 302, 307, 311, 314, 316, 367, 374, &
    380, 385, 389, 392, 394, 440, 446, 451, 455, 458, 460, 501, 506, 510, 513, 515, &
    551, 555, 558, 560, 591, 594, 596, 622, 624, 645, 317, 329, 340, 350, 359, 367, &
    374, 380, 395, 406, 416, 425, 433, 440, 446, 461, 471, 480, 488, 495, 501, 516, &
    525, 533, 540, 546, 561, 569, 576, 582, 597, 604, 610, 625, 631, 646, 329, 340, &
    350, 359, 367, 374, 380, 385, 406, 416, 425, 433, 440, 446, 451, 471, 480, 488, &
    495, 501, 506, 525, 533, 540, 546, 551, 569, 576, 582, 587, 604, 610, 615, 631, &
    636, 651, 340, 350, 359, 367, 374, 380, 385, 389, 416, 425, 433, 440, 446, 451, &
    455, 480, 488, 495, 501, 506, 510, 533, 540, 546, 551, 555, 576, 582, 587, 591, &
    610, 615, 619, 636, 640, 655, 350, 359, 367, 374, 380, 385, 389, 392, 425, 433, &
    440, 446, 451, 455, 458, 488, 495, 501, 506, 510, 513, 540, 546, 551, 555, 558, &
    582, 587, 591, 594, 615, 619, 622, 640, 643, 658, 359, 367, 374, 380, 385, 389, &
    392, 394, 433, 440, 446, 451, 455, 458, 460, 495, 501, 506, 510, 513, 515, 546, &
    551, 555, 558, 560, 587, 591, 594, 596, 619, 622, 624, 643, 645, 660, 395, 406, &
    416, 425, 433, 440, 446, 451, 461, 471, 480, 488, 495, 501, 506, 516, 525, 533, &
    540, 546, 551, 561, 569, 576, 582, 587, 597, 604, 610, 615, 625, 631, 636, 646, &
    651, 661, 406, 416, 425, 433, 440, 446, 451, 455, 471, 480, 488, 495, 501, 506, &
    510, 525, 533, 540, 546, 551, 555, 569, 576, 582, 587, 591, 604, 610, 615, 619, &
    631, 636, 640, 651, 655, 665, 416, 425, 433, 440, 446, 451, 455, 458, 480, 488, &
    495, 501, 506, 510, 513, 533, 540, 546, 551, 555, 558, 576, 582, 587, 591, 594, &
    610, 615, 619, 622, 636, 640, 643, 655, 658, 668, 425, 433, 440, 446, 451, 455, &
    458, 460, 488, 495, 501, 506, 510, 513, 515, 540, 546, 551, 555, 558, 560, 582, &
    587, 591, 594, 596, 615, 619, 622, 624, 640, 643, 645, 658, 660, 670, 461, 471, &
    480, 488, 495, 501, 506, 510, 516, 525, 533, 540, 546, 551, 555, 561, 569, 576, &
    582, 587, 591, 597, 604, 610, 615, 619, 625, 631, 636, 640, 646, 651, 655, 661, &
    665, 671, 471, 480, 488, 495, 501, 506, 510, 513, 525, 533, 540, 546, 551, 555, &
    558, 569, 576, 582, 587, 591, 594, 604, 610, 615, 619, 622, 631, 636, 640, 643, &
    651, 655, 658, 665, 668, 674, 480, 488, 495, 501, 506, 510, 513, 515, 533, 540, &
    546, 551, 555, 558, 560, 576, 582, 587, 591, 594, 596, 610, 615, 619, 622, 624, &
    636, 640, 643, 645, 655, 658, 660, 668, 670, 676, 516, 525, 533, 540, 546, 551, &
    555, 558, 561, 569, 576, 582, 587, 591, 594, 597, 604, 610, 615, 619, 622, 625, &
    631, 636, 640, 643, 646, 651, 655, 658, 661, 665, 668, 671, 674, 677, 525, 533, &
    540, 546, 551, 555, 558, 560, 569, 576, 582, 587, 591, 594, 596, 604, 610, 615, &
    619, 622, 624, 631, 636, 640, 643, 645, 651, 655, 658, 660, 665, 668, 670, 674, &
    676, 679, 561, 569, 576, 582, 587, 591, 594, 596, 597, 604, 610, 615, 619, 622, &
    624, 625, 631, 636, 640, 643, 645, 646, 651, 655, 658, 660, 661, 665, 668, 670, &
    671, 674, 676, 677, 679, 680], [36, 36])

contains

subroutine auto2e_RCopy_7_7(T, R, idx)
real(F64), dimension(:), intent(out) :: T
real(F64), dimension(:), intent(in) :: R
integer, dimension(:), intent(in) :: idx
T(1:8) = R(idx(1):idx(1)+7)
T(9:15) = R(idx(2):idx(2)+6)
T(16:21) = R(idx(3):idx(3)+5)
T(22:26) = R(idx(4):idx(4)+4)
T(27:30) = R(idx(5):idx(5)+3)
T(31:33) = R(idx(6):idx(6)+2)
T(34:35) = R(idx(7):idx(7)+1)
T(36) = R(idx(8))
T(37:43) = R(idx(9):idx(9)+6)
T(44:49) = R(idx(10):idx(10)+5)
T(50:54) = R(idx(11):idx(11)+4)
T(55:58) = R(idx(12):idx(12)+3)
T(59:61) = R(idx(13):idx(13)+2)
T(62:63) = R(idx(14):idx(14)+1)
T(64) = R(idx(15))
T(65:70) = R(idx(16):idx(16)+5)
T(71:75) = R(idx(17):idx(17)+4)
T(76:79) = R(idx(18):idx(18)+3)
T(80:82) = R(idx(19):idx(19)+2)
T(83:84) = R(idx(20):idx(20)+1)
T(85) = R(idx(21))
T(86:90) = R(idx(22):idx(22)+4)
T(91:94) = R(idx(23):idx(23)+3)
T(95:97) = R(idx(24):idx(24)+2)
T(98:99) = R(idx(25):idx(25)+1)
T(100) = R(idx(26))
T(101:104) = R(idx(27):idx(27)+3)
T(105:107) = R(idx(28):idx(28)+2)
T(108:109) = R(idx(29):idx(29)+1)
T(110) = R(idx(30))
T(111:113) = R(idx(31):idx(31)+2)
T(114:115) = R(idx(32):idx(32)+1)
T(116) = R(idx(33))
T(117:118) = R(idx(34):idx(34)+1)
T(119) = R(idx(35))
T(120) = R(idx(36))
end subroutine auto2e_RCopy_7_7

subroutine auto2e_RCopy_KetTransform_7_7(S, T, Ex, Ey, Ez, R, lx, ly, lz)
!
! Transform the ket shell pair from Hermite to Cartesian Gaussian basis.
! This variant of the transformation algorithm starts by copying the Rtuv
! matrix elements into contiguous memory locations.
!
real(F64), dimension(:), intent(out) :: S
real(F64), dimension(:), intent(out) :: T
real(F64), dimension(:), intent(in) :: Ex, Ey, Ez
real(F64), dimension(:), intent(in) :: R
integer, intent(in) :: lx, ly, lz
real(F64) :: c
integer :: tau, nu, phi, i
integer :: x0, y0, z0, x, y, z
S = ZERO
x0 = ((lx + 1) * lx) / 2 + 1
y0 = ((ly + 1) * ly) / 2 + 1
z0 = ((lz + 1) * lz) / 2 + 1
do phi = 0, lz
do nu = 0, ly
do tau = 0, lx
i = ((2*7+3-phi)*phi)/2+nu+1
call auto2e_Rcopy_7_7(T, R(tau+1:), RCopyIdx_7_7(:, i))
x = x0 + tau
y = y0 + nu
z = z0 + phi
c = (-1)**modulo(tau+nu+phi, 2)*Ex(x)*Ey(y)*Ez(z)
S = S + c * T
end do
end do
end do
end subroutine auto2e_RCopy_KetTransform_7_7
end module auto2e_KetTransform_7_7