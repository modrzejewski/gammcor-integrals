module auto2e_KetTransform_10_7
use arithmetic
use math_constants
implicit none

integer, dimension(66, 36), parameter :: RCopyIdx_10_7 = reshape([1, 19, 36, 52, &
    67, 81, 94, 106, 117, 127, 136, 172, 189, 205, 220, 234, 247, 259, 270, 280, &
    289, 325, 341, 356, 370, 383, 395, 406, 416, 425, 461, 476, 490, 503, 515, 526, &
    536, 545, 581, 595, 608, 620, 631, 641, 650, 686, 699, 711, 722, 732, 741, 777, &
    789, 800, 810, 819, 855, 866, 876, 885, 921, 931, 940, 976, 985, 1021, 19, 36, &
    52, 67, 81, 94, 106, 117, 127, 136, 144, 189, 205, 220, 234, 247, 259, 270, 280, &
    289, 297, 341, 356, 370, 383, 395, 406, 416, 425, 433, 476, 490, 503, 515, 526, &
    536, 545, 553, 595, 608, 620, 631, 641, 650, 658, 699, 711, 722, 732, 741, 749, &
    789, 800, 810, 819, 827, 866, 876, 885, 893, 931, 940, 948, 985, 993, 1029, 36, &
    52, 67, 81, 94, 106, 117, 127, 136, 144, 151, 205, 220, 234, 247, 259, 270, 280, &
    289, 297, 304, 356, 370, 383, 395, 406, 416, 425, 433, 440, 490, 503, 515, 526, &
    536, 545, 553, 560, 608, 620, 631, 641, 650, 658, 665, 711, 722, 732, 741, 749, &
    756, 800, 810, 819, 827, 834, 876, 885, 893, 900, 940, 948, 955, 993, 1000, 1036, &
    52, 67, 81, 94, 106, 117, 127, 136, 144, 151, 157, 220, 234, 247, 259, 270, 280, &
    289, 297, 304, 310, 370, 383, 395, 406, 416, 425, 433, 440, 446, 503, 515, 526, &
    536, 545, 553, 560, 566, 620, 631, 641, 650, 658, 665, 671, 722, 732, 741, 749, &
    756, 762, 810, 819, 827, 834, 840, 885, 893, 900, 906, 948, 955, 961, 1000, 1006, &
    1042, 67, 81, 94, 106, 117, 127, 136, 144, 151, 157, 162, 234, 247, 259, 270, &
    280, 289, 297, 304, 310, 315, 383, 395, 406, 416, 425, 433, 440, 446, 451, 515, &
    526, 536, 545, 553, 560, 566, 571, 631, 641, 650, 658, 665, 671, 676, 732, 741, &
    749, 756, 762, 767, 819, 827, 834, 840, 845, 893, 900, 906, 911, 955, 961, 966, &
    1006, 1011, 1047, 81, 94, 106, 117, 127, 136, 144, 151, 157, 162, 166, 247, 259, &
    270, 280, 289, 297, 304, 310, 315, 319, 395, 406, 416, 425, 433, 440, 446, 451, &
    455, 526, 536, 545, 553, 560, 566, 571, 575, 641, 650, 658, 665, 671, 676, 680, &
    741, 749, 756, 762, 767, 771, 827, 834, 840, 845, 849, 900, 906, 911, 915, 961, &
    966, 970, 1011, 1015, 1051, 94, 106, 117, 127, 136, 144, 151, 157, 162, 166, &
    169, 259, 270, 280, 289, 297, 304, 310, 315, 319, 322, 406, 416, 425, 433, 440, &
    446, 451, 455, 458, 536, 545, 553, 560, 566, 571, 575, 578, 650, 658, 665, 671, &
    676, 680, 683, 749, 756, 762, 767, 771, 774, 834, 840, 845, 849, 852, 906, 911, &
    915, 918, 966, 970, 973, 1015, 1018, 1054, 106, 117, 127, 136, 144, 151, 157, &
    162, 166, 169, 171, 270, 280, 289, 297, 304, 310, 315, 319, 322, 324, 416, 425, &
    433, 440, 446, 451, 455, 458, 460, 545, 553, 560, 566, 571, 575, 578, 580, 658, &
    665, 671, 676, 680, 683, 685, 756, 762, 767, 771, 774, 776, 840, 845, 849, 852, &
    854, 911, 915, 918, 920, 970, 973, 975, 1018, 1020, 1056, 172, 189, 205, 220, &
    234, 247, 259, 270, 280, 289, 297, 325, 341, 356, 370, 383, 395, 406, 416, 425, &
    433, 461, 476, 490, 503, 515, 526, 536, 545, 553, 581, 595, 608, 620, 631, 641, &
    650, 658, 686, 699, 711, 722, 732, 741, 749, 777, 789, 800, 810, 819, 827, 855, &
    866, 876, 885, 893, 921, 931, 940, 948, 976, 985, 993, 1021, 1029, 1057, 189, &
    205, 220, 234, 247, 259, 270, 280, 289, 297, 304, 341, 356, 370, 383, 395, 406, &
    416, 425, 433, 440, 476, 490, 503, 515, 526, 536, 545, 553, 560, 595, 608, 620, &
    631, 641, 650, 658, 665, 699, 711, 722, 732, 741, 749, 756, 789, 800, 810, 819, &
    827, 834, 866, 876, 885, 893, 900, 931, 940, 948, 955, 985, 993, 1000, 1029, &
    1036, 1064, 205, 220, 234, 247, 259, 270, 280, 289, 297, 304, 310, 356, 370, &
    383, 395, 406, 416, 425, 433, 440, 446, 490, 503, 515, 526, 536, 545, 553, 560, &
    566, 608, 620, 631, 641, 650, 658, 665, 671, 711, 722, 732, 741, 749, 756, 762, &
    800, 810, 819, 827, 834, 840, 876, 885, 893, 900, 906, 940, 948, 955, 961, 993, &
    1000, 1006, 1036, 1042, 1070, 220, 234, 247, 259, 270, 280, 289, 297, 304, 310, &
    315, 370, 383, 395, 406, 416, 425, 433, 440, 446, 451, 503, 515, 526, 536, 545, &
    553, 560, 566, 571, 620, 631, 641, 650, 658, 665, 671, 676, 722, 732, 741, 749, &
    756, 762, 767, 810, 819, 827, 834, 840, 845, 885, 893, 900, 906, 911, 948, 955, &
    961, 966, 1000, 1006, 1011, 1042, 1047, 1075, 234, 247, 259, 270, 280, 289, 297, &
    304, 310, 315, 319, 383, 395, 406, 416, 425, 433, 440, 446, 451, 455, 515, 526, &
    536, 545, 553, 560, 566, 571, 575, 631, 641, 650, 658, 665, 671, 676, 680, 732, &
    741, 749, 756, 762, 767, 771, 819, 827, 834, 840, 845, 849, 893, 900, 906, 911, &
    915, 955, 961, 966, 970, 1006, 1011, 1015, 1047, 1051, 1079, 247, 259, 270, 280, &
    289, 297, 304, 310, 315, 319, 322, 395, 406, 416, 425, 433, 440, 446, 451, 455, &
    458, 526, 536, 545, 553, 560, 566, 571, 575, 578, 641, 650, 658, 665, 671, 676, &
    680, 683, 741, 749, 756, 762, 767, 771, 774, 827, 834, 840, 845, 849, 852, 900, &
    906, 911, 915, 918, 961, 966, 970, 973, 1011, 1015, 1018, 1051, 1054, 1082, 259, &
    270, 280, 289, 297, 304, 310, 315, 319, 322, 324, 406, 416, 425, 433, 440, 446, &
    451, 455, 458, 460, 536, 545, 553, 560, 566, 571, 575, 578, 580, 650, 658, 665, &
    671, 676, 680, 683, 685, 749, 756, 762, 767, 771, 774, 776, 834, 840, 845, 849, &
    852, 854, 906, 911, 915, 918, 920, 966, 970, 973, 975, 1015, 1018, 1020, 1054, &
    1056, 1084, 325, 341, 356, 370, 383, 395, 406, 416, 425, 433, 440, 461, 476, &
    490, 503, 515, 526, 536, 545, 553, 560, 581, 595, 608, 620, 631, 641, 650, 658, &
    665, 686, 699, 711, 722, 732, 741, 749, 756, 777, 789, 800, 810, 819, 827, 834, &
    855, 866, 876, 885, 893, 900, 921, 931, 940, 948, 955, 976, 985, 993, 1000, 1021, &
    1029, 1036, 1057, 1064, 1085, 341, 356, 370, 383, 395, 406, 416, 425, 433, 440, &
    446, 476, 490, 503, 515, 526, 536, 545, 553, 560, 566, 595, 608, 620, 631, 641, &
    650, 658, 665, 671, 699, 711, 722, 732, 741, 749, 756, 762, 789, 800, 810, 819, &
    827, 834, 840, 866, 876, 885, 893, 900, 906, 931, 940, 948, 955, 961, 985, 993, &
    1000, 1006, 1029, 1036, 1042, 1064, 1070, 1091, 356, 370, 383, 395, 406, 416, &
    425, 433, 440, 446, 451, 490, 503, 515, 526, 536, 545, 553, 560, 566, 571, 608, &
    620, 631, 641, 650, 658, 665, 671, 676, 711, 722, 732, 741, 749, 756, 762, 767, &
    800, 810, 819, 827, 834, 840, 845, 876, 885, 893, 900, 906, 911, 940, 948, 955, &
    961, 966, 993, 1000, 1006, 1011, 1036, 1042, 1047, 1070, 1075, 1096, 370, 383, &
    395, 406, 416, 425, 433, 440, 446, 451, 455, 503, 515, 526, 536, 545, 553, 560, &
    566, 571, 575, 620, 631, 641, 650, 658, 665, 671, 676, 680, 722, 732, 741, 749, &
    756, 762, 767, 771, 810, 819, 827, 834, 840, 845, 849, 885, 893, 900, 906, 911, &
    915, 948, 955, 961, 966, 970, 1000, 1006, 1011, 1015, 1042, 1047, 1051, 1075, &
    1079, 1100, 383, 395, 406, 416, 425, 433, 440, 446, 451, 455, 458, 515, 526, &
    536, 545, 553, 560, 566, 571, 575, 578, 631, 641, 650, 658, 665, 671, 676, 680, &
    683, 732, 741, 749, 756, 762, 767, 771, 774, 819, 827, 834, 840, 845, 849, 852, &
    893, 900, 906, 911, 915, 918, 955, 961, 966, 970, 973, 1006, 1011, 1015, 1018, &
    1047, 1051, 1054, 1079, 1082, 1103, 395, 406, 416, 425, 433, 440, 446, 451, 455, &
    458, 460, 526, 536, 545, 553, 560, 566, 571, 575, 578, 580, 641, 650, 658, 665, &
    671, 676, 680, 683, 685, 741, 749, 756, 762, 767, 771, 774, 776, 827, 834, 840, &
    845, 849, 852, 854, 900, 906, 911, 915, 918, 920, 961, 966, 970, 973, 975, 1011, &
    1015, 1018, 1020, 1051, 1054, 1056, 1082, 1084, 1105, 461, 476, 490, 503, 515, &
    526, 536, 545, 553, 560, 566, 581, 595, 608, 620, 631, 641, 650, 658, 665, 671, &
    686, 699, 711, 722, 732, 741, 749, 756, 762, 777, 789, 800, 810, 819, 827, 834, &
    840, 855, 866, 876, 885, 893, 900, 906, 921, 931, 940, 948, 955, 961, 976, 985, &
    993, 1000, 1006, 1021, 1029, 1036, 1042, 1057, 1064, 1070, 1085, 1091, 1106, &
    476, 490, 503, 515, 526, 536, 545, 553, 560, 566, 571, 595, 608, 620, 631, 641, &
    650, 658, 665, 671, 676, 699, 711, 722, 732, 741, 749, 756, 762, 767, 789, 800, &
    810, 819, 827, 834, 840, 845, 866, 876, 885, 893, 900, 906, 911, 931, 940, 948, &
    955, 961, 966, 985, 993, 1000, 1006, 1011, 1029, 1036, 1042, 1047, 1064, 1070, &
    1075, 1091, 1096, 1111, 490, 503, 515, 526, 536, 545, 553, 560, 566, 571, 575, &
    608, 620, 631, 641, 650, 658, 665, 671, 676, 680, 711, 722, 732, 741, 749, 756, &
    762, 767, 771, 800, 810, 819, 827, 834, 840, 845, 849, 876, 885, 893, 900, 906, &
    911, 915, 940, 948, 955, 961, 966, 970, 993, 1000, 1006, 1011, 1015, 1036, 1042, &
    1047, 1051, 1070, 1075, 1079, 1096, 1100, 1115, 503, 515, 526, 536, 545, 553, &
    560, 566, 571, 575, 578, 620, 631, 641, 650, 658, 665, 671, 676, 680, 683, 722, &
    732, 741, 749, 756, 762, 767, 771, 774, 810, 819, 827, 834, 840, 845, 849, 852, &
    885, 893, 900, 906, 911, 915, 918, 948, 955, 961, 966, 970, 973, 1000, 1006, &
    1011, 1015, 1018, 1042, 1047, 1051, 1054, 1075, 1079, 1082, 1100, 1103, 1118, &
    515, 526, 536, 545, 553, 560, 566, 571, 575, 578, 580, 631, 641, 650, 658, 665, &
    671, 676, 680, 683, 685, 732, 741, 749, 756, 762, 767, 771, 774, 776, 819, 827, &
    834, 840, 845, 849, 852, 854, 893, 900, 906, 911, 915, 918, 920, 955, 961, 966, &
    970, 973, 975, 1006, 1011, 1015, 1018, 1020, 1047, 1051, 1054, 1056, 1079, 1082, &
    1084, 1103, 1105, 1120, 581, 595, 608, 620, 631, 641, 650, 658, 665, 671, 676, &
    686, 699, 711, 722, 732, 741, 749, 756, 762, 767, 777, 789, 800, 810, 819, 827, &
    834, 840, 845, 855, 866, 876, 885, 893, 900, 906, 911, 921, 931, 940, 948, 955, &
    961, 966, 976, 985, 993, 1000, 1006, 1011, 1021, 1029, 1036, 1042, 1047, 1057, &
    1064, 1070, 1075, 1085, 1091, 1096, 1106, 1111, 1121, 595, 608, 620, 631, 641, &
    650, 658, 665, 671, 676, 680, 699, 711, 722, 732, 741, 749, 756, 762, 767, 771, &
    789, 800, 810, 819, 827, 834, 840, 845, 849, 866, 876, 885, 893, 900, 906, 911, &
    915, 931, 940, 948, 955, 961, 966, 970, 985, 993, 1000, 1006, 1011, 1015, 1029, &
    1036, 1042, 1047, 1051, 1064, 1070, 1075, 1079, 1091, 1096, 1100, 1111, 1115, &
    1125, 608, 620, 631, 641, 650, 658, 665, 671, 676, 680, 683, 711, 722, 732, 741, &
    749, 756, 762, 767, 771, 774, 800, 810, 819, 827, 834, 840, 845, 849, 852, 876, &
    885, 893, 900, 906, 911, 915, 918, 940, 948, 955, 961, 966, 970, 973, 993, 1000, &
    1006, 1011, 1015, 1018, 1036, 1042, 1047, 1051, 1054, 1070, 1075, 1079, 1082, &
    1096, 1100, 1103, 1115, 1118, 1128, 620, 631, 641, 650, 658, 665, 671, 676, 680, &
    683, 685, 722, 732, 741, 749, 756, 762, 767, 771, 774, 776, 810, 819, 827, 834, &
    840, 845, 849, 852, 854, 885, 893, 900, 906, 911, 915, 918, 920, 948, 955, 961, &
    966, 970, 973, 975, 1000, 1006, 1011, 1015, 1018, 1020, 1042, 1047, 1051, 1054, &
    1056, 1075, 1079, 1082, 1084, 1100, 1103, 1105, 1118, 1120, 1130, 686, 699, 711, &
    722, 732, 741, 749, 756, 762, 767, 771, 777, 789, 800, 810, 819, 827, 834, 840, &
    845, 849, 855, 866, 876, 885, 893, 900, 906, 911, 915, 921, 931, 940, 948, 955, &
    961, 966, 970, 976, 985, 993, 1000, 1006, 1011, 1015, 1021, 1029, 1036, 1042, &
    1047, 1051, 1057, 1064, 1070, 1075, 1079, 1085, 1091, 1096, 1100, 1106, 1111, &
    1115, 1121, 1125, 1131, 699, 711, 722, 732, 741, 749, 756, 762, 767, 771, 774, &
    789, 800, 810, 819, 827, 834, 840, 845, 849, 852, 866, 876, 885, 893, 900, 906, &
    911, 915, 918, 931, 940, 948, 955, 961, 966, 970, 973, 985, 993, 1000, 1006, &
    1011, 1015, 1018, 1029, 1036, 1042, 1047, 1051, 1054, 1064, 1070, 1075, 1079, &
    1082, 1091, 1096, 1100, 1103, 1111, 1115, 1118, 1125, 1128, 1134, 711, 722, 732, &
    741, 749, 756, 762, 767, 771, 774, 776, 800, 810, 819, 827, 834, 840, 845, 849, &
    852, 854, 876, 885, 893, 900, 906, 911, 915, 918, 920, 940, 948, 955, 961, 966, &
    970, 973, 975, 993, 1000, 1006, 1011, 1015, 1018, 1020, 1036, 1042, 1047, 1051, &
    1054, 1056, 1070, 1075, 1079, 1082, 1084, 1096, 1100, 1103, 1105, 1115, 1118, &
    1120, 1128, 1130, 1136, 777, 789, 800, 810, 819, 827, 834, 840, 845, 849, 852, &
    855, 866, 876, 885, 893, 900, 906, 911, 915, 918, 921, 931, 940, 948, 955, 961, &
    966, 970, 973, 976, 985, 993, 1000, 1006, 1011, 1015, 1018, 1021, 1029, 1036, &
    1042, 1047, 1051, 1054, 1057, 1064, 1070, 1075, 1079, 1082, 1085, 1091, 1096, &
    1100, 1103, 1106, 1111, 1115, 1118, 1121, 1125, 1128, 1131, 1134, 1137, 789, &
    800, 810, 819, 827, 834, 840, 845, 849, 852, 854, 866, 876, 885, 893, 900, 906, &
    911, 915, 918, 920, 931, 940, 948, 955, 961, 966, 970, 973, 975, 985, 993, 1000, &
    1006, 1011, 1015, 1018, 1020, 1029, 1036, 1042, 1047, 1051, 1054, 1056, 1064, &
    1070, 1075, 1079, 1082, 1084, 1091, 1096, 1100, 1103, 1105, 1111, 1115, 1118, &
    1120, 1125, 1128, 1130, 1134, 1136, 1139, 855, 866, 876, 885, 893, 900, 906, &
    911, 915, 918, 920, 921, 931, 940, 948, 955, 961, 966, 970, 973, 975, 976, 985, &
    993, 1000, 1006, 1011, 1015, 1018, 1020, 1021, 1029, 1036, 1042, 1047, 1051, &
    1054, 1056, 1057, 1064, 1070, 1075, 1079, 1082, 1084, 1085, 1091, 1096, 1100, &
    1103, 1105, 1106, 1111, 1115, 1118, 1120, 1121, 1125, 1128, 1130, 1131, 1134, &
    1136, 1137, 1139, 1140], [66, 36])

contains

subroutine auto2e_RCopy_10_7(T, R, idx)
real(F64), dimension(:), intent(out) :: T
real(F64), dimension(:), intent(in) :: R
integer, dimension(:), intent(in) :: idx
T(1:11) = R(idx(1):idx(1)+10)
T(12:21) = R(idx(2):idx(2)+9)
T(22:30) = R(idx(3):idx(3)+8)
T(31:38) = R(idx(4):idx(4)+7)
T(39:45) = R(idx(5):idx(5)+6)
T(46:51) = R(idx(6):idx(6)+5)
T(52:56) = R(idx(7):idx(7)+4)
T(57:60) = R(idx(8):idx(8)+3)
T(61:63) = R(idx(9):idx(9)+2)
T(64:65) = R(idx(10):idx(10)+1)
T(66) = R(idx(11))
T(67:76) = R(idx(12):idx(12)+9)
T(77:85) = R(idx(13):idx(13)+8)
T(86:93) = R(idx(14):idx(14)+7)
T(94:100) = R(idx(15):idx(15)+6)
T(101:106) = R(idx(16):idx(16)+5)
T(107:111) = R(idx(17):idx(17)+4)
T(112:115) = R(idx(18):idx(18)+3)
T(116:118) = R(idx(19):idx(19)+2)
T(119:120) = R(idx(20):idx(20)+1)
T(121) = R(idx(21))
T(122:130) = R(idx(22):idx(22)+8)
T(131:138) = R(idx(23):idx(23)+7)
T(139:145) = R(idx(24):idx(24)+6)
T(146:151) = R(idx(25):idx(25)+5)
T(152:156) = R(idx(26):idx(26)+4)
T(157:160) = R(idx(27):idx(27)+3)
T(161:163) = R(idx(28):idx(28)+2)
T(164:165) = R(idx(29):idx(29)+1)
T(166) = R(idx(30))
T(167:174) = R(idx(31):idx(31)+7)
T(175:181) = R(idx(32):idx(32)+6)
T(182:187) = R(idx(33):idx(33)+5)
T(188:192) = R(idx(34):idx(34)+4)
T(193:196) = R(idx(35):idx(35)+3)
T(197:199) = R(idx(36):idx(36)+2)
T(200:201) = R(idx(37):idx(37)+1)
T(202) = R(idx(38))
T(203:209) = R(idx(39):idx(39)+6)
T(210:215) = R(idx(40):idx(40)+5)
T(216:220) = R(idx(41):idx(41)+4)
T(221:224) = R(idx(42):idx(42)+3)
T(225:227) = R(idx(43):idx(43)+2)
T(228:229) = R(idx(44):idx(44)+1)
T(230) = R(idx(45))
T(231:236) = R(idx(46):idx(46)+5)
T(237:241) = R(idx(47):idx(47)+4)
T(242:245) = R(idx(48):idx(48)+3)
T(246:248) = R(idx(49):idx(49)+2)
T(249:250) = R(idx(50):idx(50)+1)
T(251) = R(idx(51))
T(252:256) = R(idx(52):idx(52)+4)
T(257:260) = R(idx(53):idx(53)+3)
T(261:263) = R(idx(54):idx(54)+2)
T(264:265) = R(idx(55):idx(55)+1)
T(266) = R(idx(56))
T(267:270) = R(idx(57):idx(57)+3)
T(271:273) = R(idx(58):idx(58)+2)
T(274:275) = R(idx(59):idx(59)+1)
T(276) = R(idx(60))
T(277:279) = R(idx(61):idx(61)+2)
T(280:281) = R(idx(62):idx(62)+1)
T(282) = R(idx(63))
T(283:284) = R(idx(64):idx(64)+1)
T(285) = R(idx(65))
T(286) = R(idx(66))
end subroutine auto2e_RCopy_10_7

subroutine auto2e_RCopy_KetTransform_10_7(S, T, Ex, Ey, Ez, R, lx, ly, lz)
!
! Transform the ket shell pair from Hermite to Cartesian Gaussian basis.
! This variant of the transformation algorithm starts by copying the Rtuv
! matrix elements into contiguous memory locations.
!
real(F64), dimension(:), intent(out) :: S
real(F64), dimension(:), intent(out) :: T
real(F64), dimension(:), intent(in) :: Ex, Ey, Ez
real(F64), dimension(:), intent(in) :: R
integer, intent(in) :: lx, ly, lz
real(F64) :: c
integer :: tau, nu, phi, i
integer :: x0, y0, z0, x, y, z
S = ZERO
x0 = ((lx + 1) * lx) / 2 + 1
y0 = ((ly + 1) * ly) / 2 + 1
z0 = ((lz + 1) * lz) / 2 + 1
do phi = 0, lz
do nu = 0, ly
do tau = 0, lx
i = ((2*7+3-phi)*phi)/2+nu+1
call auto2e_Rcopy_10_7(T, R(tau+1:), RCopyIdx_10_7(:, i))
x = x0 + tau
y = y0 + nu
z = z0 + phi
c = (-1)**modulo(tau+nu+phi, 2)*Ex(x)*Ey(y)*Ez(z)
S = S + c * T
end do
end do
end do
end subroutine auto2e_RCopy_KetTransform_10_7
end module auto2e_KetTransform_10_7