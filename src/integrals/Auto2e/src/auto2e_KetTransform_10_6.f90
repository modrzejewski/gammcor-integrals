module auto2e_KetTransform_10_6
use arithmetic
use math_constants
implicit none

integer, dimension(66, 28), parameter :: RCopyIdx_10_6 = reshape([1, 18, 34, 49, &
    63, 76, 88, 99, 109, 118, 126, 154, 170, 185, 199, 212, 224, 235, 245, 254, 262, &
    290, 305, 319, 332, 344, 355, 365, 374, 382, 410, 424, 437, 449, 460, 470, 479, &
    487, 515, 528, 540, 551, 561, 570, 578, 606, 618, 629, 639, 648, 656, 684, 695, &
    705, 714, 722, 750, 760, 769, 777, 805, 814, 822, 850, 858, 886, 18, 34, 49, &
    63, 76, 88, 99, 109, 118, 126, 133, 170, 185, 199, 212, 224, 235, 245, 254, 262, &
    269, 305, 319, 332, 344, 355, 365, 374, 382, 389, 424, 437, 449, 460, 470, 479, &
    487, 494, 528, 540, 551, 561, 570, 578, 585, 618, 629, 639, 648, 656, 663, 695, &
    705, 714, 722, 729, 760, 769, 777, 784, 814, 822, 829, 858, 865, 893, 34, 49, &
    63, 76, 88, 99, 109, 118, 126, 133, 139, 185, 199, 212, 224, 235, 245, 254, 262, &
    269, 275, 319, 332, 344, 355, 365, 374, 382, 389, 395, 437, 449, 460, 470, 479, &
    487, 494, 500, 540, 551, 561, 570, 578, 585, 591, 629, 639, 648, 656, 663, 669, &
    705, 714, 722, 729, 735, 769, 777, 784, 790, 822, 829, 835, 865, 871, 899, 49, &
    63, 76, 88, 99, 109, 118, 126, 133, 139, 144, 199, 212, 224, 235, 245, 254, 262, &
    269, 275, 280, 332, 344, 355, 365, 374, 382, 389, 395, 400, 449, 460, 470, 479, &
    487, 494, 500, 505, 551, 561, 570, 578, 585, 591, 596, 639, 648, 656, 663, 669, &
    674, 714, 722, 729, 735, 740, 777, 784, 790, 795, 829, 835, 840, 871, 876, 904, &
    63, 76, 88, 99, 109, 118, 126, 133, 139, 144, 148, 212, 224, 235, 245, 254, 262, &
    269, 275, 280, 284, 344, 355, 365, 374, 382, 389, 395, 400, 404, 460, 470, 479, &
    487, 494, 500, 505, 509, 561, 570, 578, 585, 591, 596, 600, 648, 656, 663, 669, &
    674, 678, 722, 729, 735, 740, 744, 784, 790, 795, 799, 835, 840, 844, 876, 880, &
    908, 76, 88, 99, 109, 118, 126, 133, 139, 144, 148, 151, 224, 235, 245, 254, &
    262, 269, 275, 280, 284, 287, 355, 365, 374, 382, 389, 395, 400, 404, 407, 470, &
    479, 487, 494, 500, 505, 509, 512, 570, 578, 585, 591, 596, 600, 603, 656, 663, &
    669, 674, 678, 681, 729, 735, 740, 744, 747, 790, 795, 799, 802, 840, 844, 847, &
    880, 883, 911, 88, 99, 109, 118, 126, 133, 139, 144, 148, 151, 153, 235, 245, &
    254, 262, 269, 275, 280, 284, 287, 289, 365, 374, 382, 389, 395, 400, 404, 407, &
    409, 479, 487, 494, 500, 505, 509, 512, 514, 578, 585, 591, 596, 600, 603, 605, &
    663, 669, 674, 678, 681, 683, 735, 740, 744, 747, 749, 795, 799, 802, 804, 844, &
    847, 849, 883, 885, 913, 154, 170, 185, 199, 212, 224, 235, 245, 254, 262, 269, &
    290, 305, 319, 332, 344, 355, 365, 374, 382, 389, 410, 424, 437, 449, 460, 470, &
    479, 487, 494, 515, 528, 540, 551, 561, 570, 578, 585, 606, 618, 629, 639, 648, &
    656, 663, 684, 695, 705, 714, 722, 729, 750, 760, 769, 777, 784, 805, 814, 822, &
    829, 850, 858, 865, 886, 893, 914, 170, 185, 199, 212, 224, 235, 245, 254, 262, &
    269, 275, 305, 319, 332, 344, 355, 365, 374, 382, 389, 395, 424, 437, 449, 460, &
    470, 479, 487, 494, 500, 528, 540, 551, 561, 570, 578, 585, 591, 618, 629, 639, &
    648, 656, 663, 669, 695, 705, 714, 722, 729, 735, 760, 769, 777, 784, 790, 814, &
    822, 829, 835, 858, 865, 871, 893, 899, 920, 185, 199, 212, 224, 235, 245, 254, &
    262, 269, 275, 280, 319, 332, 344, 355, 365, 374, 382, 389, 395, 400, 437, 449, &
    460, 470, 479, 487, 494, 500, 505, 540, 551, 561, 570, 578, 585, 591, 596, 629, &
    639, 648, 656, 663, 669, 674, 705, 714, 722, 729, 735, 740, 769, 777, 784, 790, &
    795, 822, 829, 835, 840, 865, 871, 876, 899, 904, 925, 199, 212, 224, 235, 245, &
    254, 262, 269, 275, 280, 284, 332, 344, 355, 365, 374, 382, 389, 395, 400, 404, &
    449, 460, 470, 479, 487, 494, 500, 505, 509, 551, 561, 570, 578, 585, 591, 596, &
    600, 639, 648, 656, 663, 669, 674, 678, 714, 722, 729, 735, 740, 744, 777, 784, &
    790, 795, 799, 829, 835, 840, 844, 871, 876, 880, 904, 908, 929, 212, 224, 235, &
    245, 254, 262, 269, 275, 280, 284, 287, 344, 355, 365, 374, 382, 389, 395, 400, &
    404, 407, 460, 470, 479, 487, 494, 500, 505, 509, 512, 561, 570, 578, 585, 591, &
    596, 600, 603, 648, 656, 663, 669, 674, 678, 681, 722, 729, 735, 740, 744, 747, &
    784, 790, 795, 799, 802, 835, 840, 844, 847, 876, 880, 883, 908, 911, 932, 224, &
    235, 245, 254, 262, 269, 275, 280, 284, 287, 289, 355, 365, 374, 382, 389, 395, &
    400, 404, 407, 409, 470, 479, 487, 494, 500, 505, 509, 512, 514, 570, 578, 585, &
    591, 596, 600, 603, 605, 656, 663, 669, 674, 678, 681, 683, 729, 735, 740, 744, &
    747, 749, 790, 795, 799, 802, 804, 840, 844, 847, 849, 880, 883, 885, 911, 913, &
    934, 290, 305, 319, 332, 344, 355, 365, 374, 382, 389, 395, 410, 424, 437, 449, &
    460, 470, 479, 487, 494, 500, 515, 528, 540, 551, 561, 570, 578, 585, 591, 606, &
    618, 629, 639, 648, 656, 663, 669, 684, 695, 705, 714, 722, 729, 735, 750, 760, &
    769, 777, 784, 790, 805, 814, 822, 829, 835, 850, 858, 865, 871, 886, 893, 899, &
    914, 920, 935, 305, 319, 332, 344, 355, 365, 374, 382, 389, 395, 400, 424, 437, &
    449, 460, 470, 479, 487, 494, 500, 505, 528, 540, 551, 561, 570, 578, 585, 591, &
    596, 618, 629, 639, 648, 656, 663, 669, 674, 695, 705, 714, 722, 729, 735, 740, &
    760, 769, 777, 784, 790, 795, 814, 822, 829, 835, 840, 858, 865, 871, 876, 893, &
    899, 904, 920, 925, 940, 319, 332, 344, 355, 365, 374, 382, 389, 395, 400, 404, &
    437, 449, 460, 470, 479, 487, 494, 500, 505, 509, 540, 551, 561, 570, 578, 585, &
    591, 596, 600, 629, 639, 648, 656, 663, 669, 674, 678, 705, 714, 722, 729, 735, &
    740, 744, 769, 777, 784, 790, 795, 799, 822, 829, 835, 840, 844, 865, 871, 876, &
    880, 899, 904, 908, 925, 929, 944, 332, 344, 355, 365, 374, 382, 389, 395, 400, &
    404, 407, 449, 460, 470, 479, 487, 494, 500, 505, 509, 512, 551, 561, 570, 578, &
    585, 591, 596, 600, 603, 639, 648, 656, 663, 669, 674, 678, 681, 714, 722, 729, &
    735, 740, 744, 747, 777, 784, 790, 795, 799, 802, 829, 835, 840, 844, 847, 871, &
    876, 880, 883, 904, 908, 911, 929, 932, 947, 344, 355, 365, 374, 382, 389, 395, &
    400, 404, 407, 409, 460, 470, 479, 487, 494, 500, 505, 509, 512, 514, 561, 570, &
    578, 585, 591, 596, 600, 603, 605, 648, 656, 663, 669, 674, 678, 681, 683, 722, &
    729, 735, 740, 744, 747, 749, 784, 790, 795, 799, 802, 804, 835, 840, 844, 847, &
    849, 876, 880, 883, 885, 908, 911, 913, 932, 934, 949, 410, 424, 437, 449, 460, &
    470, 479, 487, 494, 500, 505, 515, 528, 540, 551, 561, 570, 578, 585, 591, 596, &
    606, 618, 629, 639, 648, 656, 663, 669, 674, 684, 695, 705, 714, 722, 729, 735, &
    740, 750, 760, 769, 777, 784, 790, 795, 805, 814, 822, 829, 835, 840, 850, 858, &
    865, 871, 876, 886, 893, 899, 904, 914, 920, 925, 935, 940, 950, 424, 437, 449, &
    460, 470, 479, 487, 494, 500, 505, 509, 528, 540, 551, 561, 570, 578, 585, 591, &
    596, 600, 618, 629, 639, 648, 656, 663, 669, 674, 678, 695, 705, 714, 722, 729, &
    735, 740, 744, 760, 769, 777, 784, 790, 795, 799, 814, 822, 829, 835, 840, 844, &
    858, 865, 871, 876, 880, 893, 899, 904, 908, 920, 925, 929, 940, 944, 954, 437, &
    449, 460, 470, 479, 487, 494, 500, 505, 509, 512, 540, 551, 561, 570, 578, 585, &
    591, 596, 600, 603, 629, 639, 648, 656, 663, 669, 674, 678, 681, 705, 714, 722, &
    729, 735, 740, 744, 747, 769, 777, 784, 790, 795, 799, 802, 822, 829, 835, 840, &
    844, 847, 865, 871, 876, 880, 883, 899, 904, 908, 911, 925, 929, 932, 944, 947, &
    957, 449, 460, 470, 479, 487, 494, 500, 505, 509, 512, 514, 551, 561, 570, 578, &
    585, 591, 596, 600, 603, 605, 639, 648, 656, 663, 669, 674, 678, 681, 683, 714, &
    722, 729, 735, 740, 744, 747, 749, 777, 784, 790, 795, 799, 802, 804, 829, 835, &
    840, 844, 847, 849, 871, 876, 880, 883, 885, 904, 908, 911, 913, 929, 932, 934, &
    947, 949, 959, 515, 528, 540, 551, 561, 570, 578, 585, 591, 596, 600, 606, 618, &
    629, 639, 648, 656, 663, 669, 674, 678, 684, 695, 705, 714, 722, 729, 735, 740, &
    744, 750, 760, 769, 777, 784, 790, 795, 799, 805, 814, 822, 829, 835, 840, 844, &
    850, 858, 865, 871, 876, 880, 886, 893, 899, 904, 908, 914, 920, 925, 929, 935, &
    940, 944, 950, 954, 960, 528, 540, 551, 561, 570, 578, 585, 591, 596, 600, 603, &
    618, 629, 639, 648, 656, 663, 669, 674, 678, 681, 695, 705, 714, 722, 729, 735, &
    740, 744, 747, 760, 769, 777, 784, 790, 795, 799, 802, 814, 822, 829, 835, 840, &
    844, 847, 858, 865, 871, 876, 880, 883, 893, 899, 904, 908, 911, 920, 925, 929, &
    932, 940, 944, 947, 954, 957, 963, 540, 551, 561, 570, 578, 585, 591, 596, 600, &
    603, 605, 629, 639, 648, 656, 663, 669, 674, 678, 681, 683, 705, 714, 722, 729, &
    735, 740, 744, 747, 749, 769, 777, 784, 790, 795, 799, 802, 804, 822, 829, 835, &
    840, 844, 847, 849, 865, 871, 876, 880, 883, 885, 899, 904, 908, 911, 913, 925, &
    929, 932, 934, 944, 947, 949, 957, 959, 965, 606, 618, 629, 639, 648, 656, 663, &
    669, 674, 678, 681, 684, 695, 705, 714, 722, 729, 735, 740, 744, 747, 750, 760, &
    769, 777, 784, 790, 795, 799, 802, 805, 814, 822, 829, 835, 840, 844, 847, 850, &
    858, 865, 871, 876, 880, 883, 886, 893, 899, 904, 908, 911, 914, 920, 925, 929, &
    932, 935, 940, 944, 947, 950, 954, 957, 960, 963, 966, 618, 629, 639, 648, 656, &
    663, 669, 674, 678, 681, 683, 695, 705, 714, 722, 729, 735, 740, 744, 747, 749, &
    760, 769, 777, 784, 790, 795, 799, 802, 804, 814, 822, 829, 835, 840, 844, 847, &
    849, 858, 865, 871, 876, 880, 883, 885, 893, 899, 904, 908, 911, 913, 920, 925, &
    929, 932, 934, 940, 944, 947, 949, 954, 957, 959, 963, 965, 968, 684, 695, 705, &
    714, 722, 729, 735, 740, 744, 747, 749, 750, 760, 769, 777, 784, 790, 795, 799, &
    802, 804, 805, 814, 822, 829, 835, 840, 844, 847, 849, 850, 858, 865, 871, 876, &
    880, 883, 885, 886, 893, 899, 904, 908, 911, 913, 914, 920, 925, 929, 932, 934, &
    935, 940, 944, 947, 949, 950, 954, 957, 959, 960, 963, 965, 966, 968, 969], [66, &
    28])

contains

subroutine auto2e_RCopy_10_6(T, R, idx)
real(F64), dimension(:), intent(out) :: T
real(F64), dimension(:), intent(in) :: R
integer, dimension(:), intent(in) :: idx
T(1:11) = R(idx(1):idx(1)+10)
T(12:21) = R(idx(2):idx(2)+9)
T(22:30) = R(idx(3):idx(3)+8)
T(31:38) = R(idx(4):idx(4)+7)
T(39:45) = R(idx(5):idx(5)+6)
T(46:51) = R(idx(6):idx(6)+5)
T(52:56) = R(idx(7):idx(7)+4)
T(57:60) = R(idx(8):idx(8)+3)
T(61:63) = R(idx(9):idx(9)+2)
T(64:65) = R(idx(10):idx(10)+1)
T(66) = R(idx(11))
T(67:76) = R(idx(12):idx(12)+9)
T(77:85) = R(idx(13):idx(13)+8)
T(86:93) = R(idx(14):idx(14)+7)
T(94:100) = R(idx(15):idx(15)+6)
T(101:106) = R(idx(16):idx(16)+5)
T(107:111) = R(idx(17):idx(17)+4)
T(112:115) = R(idx(18):idx(18)+3)
T(116:118) = R(idx(19):idx(19)+2)
T(119:120) = R(idx(20):idx(20)+1)
T(121) = R(idx(21))
T(122:130) = R(idx(22):idx(22)+8)
T(131:138) = R(idx(23):idx(23)+7)
T(139:145) = R(idx(24):idx(24)+6)
T(146:151) = R(idx(25):idx(25)+5)
T(152:156) = R(idx(26):idx(26)+4)
T(157:160) = R(idx(27):idx(27)+3)
T(161:163) = R(idx(28):idx(28)+2)
T(164:165) = R(idx(29):idx(29)+1)
T(166) = R(idx(30))
T(167:174) = R(idx(31):idx(31)+7)
T(175:181) = R(idx(32):idx(32)+6)
T(182:187) = R(idx(33):idx(33)+5)
T(188:192) = R(idx(34):idx(34)+4)
T(193:196) = R(idx(35):idx(35)+3)
T(197:199) = R(idx(36):idx(36)+2)
T(200:201) = R(idx(37):idx(37)+1)
T(202) = R(idx(38))
T(203:209) = R(idx(39):idx(39)+6)
T(210:215) = R(idx(40):idx(40)+5)
T(216:220) = R(idx(41):idx(41)+4)
T(221:224) = R(idx(42):idx(42)+3)
T(225:227) = R(idx(43):idx(43)+2)
T(228:229) = R(idx(44):idx(44)+1)
T(230) = R(idx(45))
T(231:236) = R(idx(46):idx(46)+5)
T(237:241) = R(idx(47):idx(47)+4)
T(242:245) = R(idx(48):idx(48)+3)
T(246:248) = R(idx(49):idx(49)+2)
T(249:250) = R(idx(50):idx(50)+1)
T(251) = R(idx(51))
T(252:256) = R(idx(52):idx(52)+4)
T(257:260) = R(idx(53):idx(53)+3)
T(261:263) = R(idx(54):idx(54)+2)
T(264:265) = R(idx(55):idx(55)+1)
T(266) = R(idx(56))
T(267:270) = R(idx(57):idx(57)+3)
T(271:273) = R(idx(58):idx(58)+2)
T(274:275) = R(idx(59):idx(59)+1)
T(276) = R(idx(60))
T(277:279) = R(idx(61):idx(61)+2)
T(280:281) = R(idx(62):idx(62)+1)
T(282) = R(idx(63))
T(283:284) = R(idx(64):idx(64)+1)
T(285) = R(idx(65))
T(286) = R(idx(66))
end subroutine auto2e_RCopy_10_6

subroutine auto2e_RCopy_KetTransform_10_6(S, T, Ex, Ey, Ez, R, lx, ly, lz)
!
! Transform the ket shell pair from Hermite to Cartesian Gaussian basis.
! This variant of the transformation algorithm starts by copying the Rtuv
! matrix elements into contiguous memory locations.
!
real(F64), dimension(:), intent(out) :: S
real(F64), dimension(:), intent(out) :: T
real(F64), dimension(:), intent(in) :: Ex, Ey, Ez
real(F64), dimension(:), intent(in) :: R
integer, intent(in) :: lx, ly, lz
real(F64) :: c
integer :: tau, nu, phi, i
integer :: x0, y0, z0, x, y, z
S = ZERO
x0 = ((lx + 1) * lx) / 2 + 1
y0 = ((ly + 1) * ly) / 2 + 1
z0 = ((lz + 1) * lz) / 2 + 1
do phi = 0, lz
do nu = 0, ly
do tau = 0, lx
i = ((2*6+3-phi)*phi)/2+nu+1
call auto2e_Rcopy_10_6(T, R(tau+1:), RCopyIdx_10_6(:, i))
x = x0 + tau
y = y0 + nu
z = z0 + phi
c = (-1)**modulo(tau+nu+phi, 2)*Ex(x)*Ey(y)*Ez(z)
S = S + c * T
end do
end do
end do
end subroutine auto2e_RCopy_KetTransform_10_6
end module auto2e_KetTransform_10_6